{"ast":null,"code":"import{useState,useEffect}from\"react\";import{useNavigate}from\"react-router-dom\";import Header from\"../components/Header\";import AnimatedPageWrapper from\"../components/AnimatedPageWrapper\";import ProfileForm from\"../components/ProfileForm\";import Questionnaire from\"../components/Questionnaire\";import Loader from\"../components/Loader\";import AlertBox from\"../components/AlertBox\";import{fetchQuestionnaire,runAssessment}from\"../api/assessment.api\";import{buildPayload}from\"../utils/payloadBuilder\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function AssessmentPage(){const[step,setStep]=useState(\"profile\");const[profileData,setProfileData]=useState(null);const[questions,setQuestions]=useState([]);const[loading,setLoading]=useState(false);const[darkMode,setDarkMode]=useState(true);const[alert,setAlert]=useState(\"\");const navigate=useNavigate();/* ðŸŒ™ Dark mode */useEffect(()=>{document.documentElement.classList.toggle(\"dark\",darkMode);},[darkMode]);/* STEP 1 */const handleProfileSubmit=async profile=>{setLoading(true);setProfileData(profile);try{const res=await fetchQuestionnaire(profile.currentClass);setQuestions(res.data.questions);setStep(\"questions\");}catch(_unused){setAlert(\"Failed to load questions. Please try again.\");}finally{setLoading(false);}};/* STEP 2 */const handleAssessmentSubmit=async answers=>{setLoading(true);try{const payload=buildPayload({profileData,answers});const res=await runAssessment(payload);navigate(\"/report\",{state:{reportUrl:res.data.reportUrl}});}catch(_unused2){setAlert(\"Assessment failed. Please retry.\");}finally{setLoading(false);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen transition-colors duration-300\\n        \".concat(darkMode?\"bg-gradient-to-br from-[#020617] to-[#0f172a]\":\"bg-gradient-to-br from-slate-100 to-white\"),children:[/*#__PURE__*/_jsx(Header,{darkMode:darkMode,setDarkMode:setDarkMode}),/*#__PURE__*/_jsx(AlertBox,{message:alert,onClose:()=>setAlert(\"\")}),loading&&/*#__PURE__*/_jsx(Loader,{}),/*#__PURE__*/_jsxs(AnimatedPageWrapper,{children:[step===\"profile\"&&/*#__PURE__*/_jsx(ProfileForm,{onSubmit:handleProfileSubmit,setAlert:setAlert}),step===\"questions\"&&/*#__PURE__*/_jsx(Questionnaire,{questions:questions,onSubmit:handleAssessmentSubmit})]})]});}","map":{"version":3,"names":["useState","useEffect","useNavigate","Header","AnimatedPageWrapper","ProfileForm","Questionnaire","Loader","AlertBox","fetchQuestionnaire","runAssessment","buildPayload","jsx","_jsx","jsxs","_jsxs","AssessmentPage","step","setStep","profileData","setProfileData","questions","setQuestions","loading","setLoading","darkMode","setDarkMode","alert","setAlert","navigate","document","documentElement","classList","toggle","handleProfileSubmit","profile","res","currentClass","data","_unused","handleAssessmentSubmit","answers","payload","state","reportUrl","_unused2","className","concat","children","message","onClose","onSubmit"],"sources":["C:/Users/anubh/OneDrive/Desktop/Collegereviewz/clients/src/pages/AssessmentPage.jsx"],"sourcesContent":["import { useState, useEffect } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport Header from \"../components/Header\";\nimport AnimatedPageWrapper from \"../components/AnimatedPageWrapper\";\nimport ProfileForm from \"../components/ProfileForm\";\nimport Questionnaire from \"../components/Questionnaire\";\nimport Loader from \"../components/Loader\";\nimport AlertBox from \"../components/AlertBox\";\nimport { fetchQuestionnaire, runAssessment } from \"../api/assessment.api\";\nimport { buildPayload } from \"../utils/payloadBuilder\";\n\nexport default function AssessmentPage() {\n  const [step, setStep] = useState(\"profile\");\n  const [profileData, setProfileData] = useState(null);\n  const [questions, setQuestions] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [darkMode, setDarkMode] = useState(true);\n  const [alert, setAlert] = useState(\"\");\n\n  const navigate = useNavigate();\n\n  /* ðŸŒ™ Dark mode */\n  useEffect(() => {\n    document.documentElement.classList.toggle(\"dark\", darkMode);\n  }, [darkMode]);\n\n  /* STEP 1 */\n  const handleProfileSubmit = async (profile) => {\n    setLoading(true);\n    setProfileData(profile);\n\n    try {\n      const res = await fetchQuestionnaire(profile.currentClass);\n      setQuestions(res.data.questions);\n      setStep(\"questions\");\n    } catch {\n      setAlert(\"Failed to load questions. Please try again.\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  /* STEP 2 */\n  const handleAssessmentSubmit = async (answers) => {\n    setLoading(true);\n\n    try {\n      const payload = buildPayload({ profileData, answers });\n      const res = await runAssessment(payload);\n\n      navigate(\"/report\", {\n        state: { reportUrl: res.data.reportUrl },\n      });\n    } catch {\n      setAlert(\"Assessment failed. Please retry.\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div\n      className={`min-h-screen transition-colors duration-300\n        ${\n          darkMode\n            ? \"bg-gradient-to-br from-[#020617] to-[#0f172a]\"\n            : \"bg-gradient-to-br from-slate-100 to-white\"\n        }`}\n    >\n      <Header darkMode={darkMode} setDarkMode={setDarkMode} />\n\n      <AlertBox message={alert} onClose={() => setAlert(\"\")} />\n\n      {loading && <Loader />}\n\n      <AnimatedPageWrapper>\n        {step === \"profile\" && (\n          <ProfileForm onSubmit={handleProfileSubmit} setAlert={setAlert} />\n        )}\n\n        {step === \"questions\" && (\n          <Questionnaire\n            questions={questions}\n            onSubmit={handleAssessmentSubmit}\n          />\n        )}\n      </AnimatedPageWrapper>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}